<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Booking Program</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  </head>

  <body>
    <h1>Booking Program</h1>
    
    <h2>Booked Rooms</h2>
    
  
    <table id="bookings-table">
      <thead>
        <tr>
          <th >Std.<br></th>
          <th ><b></b>
            <center><b>Mo</b></center>
          </th>
          <th ><b></b>
            <center><b>Di</b></center>
          </th>
          <th ><b></b>
            <center><b>Mi</b></center>
          </th>
          <th ><b></b>
            <center><b>Do</b></center>
          </th>
          <th ><b></b>
            <center><b>Fr</b></center>
          </th>
          <th ><b></b>
            <center><b>Sa</b></center>
          </th>
          <th ><b></b>
            <center><b>So</b></center>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>2</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>3</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>4</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>5</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>6</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>7</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>8</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>9</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>10</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>11</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>12</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>13</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>14</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>15</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>16</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
      </tbody>
    </table>


    <div id="booking_window" style="display: none;">
      <div>
        <h2>Book Room</h2>
        <p>Tag: <input id="modal-day" type="text" disabled></p>
        <p>Stunde: <input id="modal-hour" type="text" disabled></p>
        <p>Lehrer: <input id="modal-teach" type="text"></p>
        <p>Fach: <input id="modal-name" type="text"></p>

        <button onclick="saveBooking();$('#booking_window').hide();">Save</button>
        <button onclick="$('#booking_window').hide();">Cancel</button>
      </div>
    </div>

    <script>
      $('td:contains("-")').click(function() {
        if( this.textContent != "-") return false;

        var stunde = $(this).closest('tr').find('td:first-child').text();
        var tag = $(this).closest('table').find('thead th').eq($(this).index()).text();
        $('#modal-hour').val(stunde.replace(/ /g,""));
        $('#modal-day').val(tag.replace(/ /g,""));
        $('#booking_window').show();
      });



      function saveBooking(){
        data = {
          "day":$('#modal-day').val(),
          "hour":$('#modal-hour').val(),
          "teacher":$('#modal-teach').val(),
          "fach": $('#modal-name').val()
        }

        $('#modal-teach').val("")
        $('#modal-name').val("")
        
        if( ["day","hour","teacher","fach"].every(key => data[key] !== '') ){

          $.ajax({
            type: "POST",
            url: "/book",
            data: data,
            success: function(response) {
              console.log( response.statusCode )
            }
          });
        }
      }
    </script>
    <script src="/js/booking.js"></script>
  </body>

</html>